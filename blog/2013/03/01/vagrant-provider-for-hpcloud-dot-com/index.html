<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>vagrant provider for hpcloud.com - AppliedCode</title>
  <meta name="author" content="Mohit Sethi">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://appliedcode.github.io/blog/2013/03/01/vagrant-provider-for-hpcloud-dot-com">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="AppliedCode" type="application/atom+xml">

  <link href="/javascripts/libs/bootstrap-3.0.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/javascripts/libs/bootstrap-3.0.0/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44987749-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">AppliedCode</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:appliedcode.github.io">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <article class="hentry" role="article">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-03-01T14:42:00+05:30" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://appliedcode.github.io">Comments</a>
        
      </p>
    
    
    <h1 class="entry-title">
        Vagrant Provider for hpcloud.com
        
    </h1>
    
  </header>


<div class="entry-content clearfix"><p><strong>NOTE:</strong> This plugin requires Vagrant 1.1+,</p>

<h2>Features</h2>

<ul>
<li>Boot Servers on HP Cloud</li>
<li>SSH into the instances.</li>
<li>Provision the instances with any built-in Vagrant provisioner.</li>
<li>Minimal synced folder support via <code>rsync</code>.</li>
</ul>


<h2>Usage</h2>

<p>Install using standard Vagrant 1.1+ plugin installation methods. After
installing, <code>vagrant up</code> and specify the <code>hp</code> provider. An example is
shown below.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant plugin install vagrant-hp
</span><span class='line'>...
</span><span class='line'>$ vagrant up --provider=hp
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p>Of course prior to doing this, you&rsquo;ll need to obtain an HP-compatible
box file for Vagrant.</p>

<h2>Quick Start</h2>

<p>After installing the plugin (instructions above), the quickest way to get
started is to actually use a dummy HP box and specify all the details
manually within a <code>config.vm.provider</code> block. So first, add the dummy
box using any name you want:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ vagrant box add dummy https://github.com/mohitsethi/vagrant-hp/raw/master/dummy_hp.box
</span><span class='line'>...</span></code></pre></td></tr></table></div></figure>


<p>And then make a Vagrantfile that looks like the following, filling in
your information where necessary.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Vagrant.configure("2") do |config|
</span><span class='line'>  config.vm.box = "dummy"
</span><span class='line'>
</span><span class='line'>  config.vm.provider :hp do |rs|
</span><span class='line'>    rs.access_key  = "&lt;hp_access_key&gt;"
</span><span class='line'>    rs.secret_key = "&lt;hp_secret_key&gt;"
</span><span class='line'>    rs.flavor   = "standard.xsmall"
</span><span class='line'>    rs.tenant_id = "&lt;hp_tenant_id&gt;"
</span><span class='line'>    rs.server_name = "&lt;server_name&gt;"
</span><span class='line'>    rs.image    = "Ubuntu Precise 12.04 LTS Server 64-bit 20121026 (b)"
</span><span class='line'>    rs.keypair_name = "&lt;your_key_pair_name_on_hpcloud&gt;"
</span><span class='line'>    rs.ssh_private_key_path = "&lt;private_key_location&gt;"
</span><span class='line'>    rs.ssh_username = "&lt;ssh_username&gt;"
</span><span class='line'>    rs.availability_zone = "az1"
</span><span class='line'>    # Security Groups defaults to ["default"]
</span><span class='line'>    # rs.security_groups = ["group1", "group2"]
</span><span class='line'>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure>


<p>And then run <code>vagrant up --provider=hp</code>.</p>

<p>This will start an Ubuntu 12.04 instance in the az1 availability zone within
your HP Cloud account. And assuming your SSH information was filled in properly
within your Vagrantfile, SSH and provisioning will work as well.</p>

<p>Note that normally a lot of this boilerplate is encoded within the box
file, but the box file used for the quick start, the &ldquo;dummy&rdquo; box, has
no preconfigured defaults.</p>

<h2>Box Format</h2>

<p>Every provider in Vagrant must introduce a custom box format. This
provider introduces <code>hp</code> boxes. You can view an example box in
the <a href="https://github.com/mohitsethi/vagrant-hp/tree/master/example_box">example_box/ directory</a>.
That directory also contains instructions on how to build a box.</p>

<p>The box format is basically just the required <code>metadata.json</code> file
along with a <code>Vagrantfile</code> that does default settings for the
provider-specific configuration for this provider.</p>

<h2>Configuration</h2>

<p>This provider exposes quite a few provider-specific configuration options:</p>

<ul>
<li><code>access_key</code> &ndash; The access key for accessing HP Cloud</li>
<li><code>image</code> &ndash; The Image-id  or Image-Name to boot, such as
  &ldquo;Ubuntu Precise 12.04 LTS Server 64-bit 20121026 (b)&rdquo;</li>
<li><code>availability_zone</code> &ndash; The availability zone to launch the server.
  If nil, it will use &lsquo;az1&rsquo;.</li>
<li><code>flavor</code> &ndash; The type of flavor, such as &ldquo;standard.xsmall&rdquo;</li>
<li><code>keypair_name</code> &ndash; The name of the keypair to use to bootstrap image
 which support it.</li>
<li><code>secret_key</code> &ndash; The secret access key for accessing HP Cloud.</li>
<li><code>ssh_private_key_path</code> &ndash; The path to the SSH private key. This overrides
<code>config.ssh.private_key_path</code>.</li>
<li><code>ssh_username</code> &ndash; The SSH username, which overrides <code>config.ssh.username</code>.</li>
<li><code>server_name</code> &ndash; The name of the server provisioned on HP Cloud.</li>
<li><code>tenant_id</code> &ndash; The tenant_id to launch the server.</li>
<li><code>security_groups</code> &ndash; An array of strings defining the security groups in which this VM is included.</li>
</ul>


<p>These can be set like typical provider-specific configuration:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'>  <span class="c1"># ... other stuff</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provider</span> <span class="ss">:hp</span> <span class="k">do</span> <span class="o">|</span><span class="n">rs</span><span class="o">|</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">access_key</span>  <span class="o">=</span> <span class="s2">&quot;&lt;hp_access_key&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="s2">&quot;&lt;hp_secret_key&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">flavor</span>   <span class="o">=</span> <span class="s2">&quot;standard.xsmall&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">tenant_id</span> <span class="o">=</span> <span class="s2">&quot;&lt;hp_tenant_id&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">server_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;server_name&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">image</span>    <span class="o">=</span> <span class="s2">&quot;Ubuntu Precise 12.04 LTS Server 64-bit 20121026 (b)&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">keypair_name</span> <span class="o">=</span> <span class="s2">&quot;&lt;your_key_pair_name_on_hpcloud&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">ssh_private_key_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;private_key_location&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">ssh_username</span> <span class="o">=</span> <span class="s2">&quot;&lt;ssh_username&gt;&quot;</span>
</span><span class='line'>    <span class="n">rs</span><span class="o">.</span><span class="n">availability_zone</span> <span class="o">=</span> <span class="s2">&quot;az1&quot;</span>
</span><span class='line'>    <span class="c1"># Security Groups defaults to [&quot;default&quot;]</span>
</span><span class='line'>    <span class="c1"># rs.security_groups = [&quot;group1&quot;, &quot;group2&quot;]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Networks</h2>

<p>Networking features in the form of <code>config.vm.network</code> are not
supported with <code>vagrant-hp</code>, currently. If any of these are
specified, Vagrant will emit a warning, but will otherwise boot
the HP machine.</p>

<h2>Synced Folders</h2>

<p>There is minimal support for synced folders. Upon <code>vagrant up</code>,
<code>vagrant reload</code>, and <code>vagrant provision</code>, the HP provider will use
<code>rsync</code> (if available) to uni-directionally sync the folder to
the remote machine over SSH.</p>

<p>This is good enough for all built-in Vagrant provisioners (shell,
chef, and puppet) to work!</p>

<h2>Development</h2>

<p>To work on the <code>vagrant-hp</code> plugin, clone this repository out, and use
<a href="http://gembundler.com">Bundler</a> to get the dependencies:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">bundle</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once you have the dependencies, verify the unit tests pass with <code>rake</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">rake</span>
</span></code></pre></td></tr></table></div></figure>


<p>If those pass, you&rsquo;re ready to start developing the plugin. You can test
the plugin without installing it into your Vagrant environment by just
creating a <code>Vagrantfile</code> in the top level of this directory (it is gitignored)
that uses it, and uses bundler to execute Vagrant:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">vagrant</span> <span class="n">up</span> <span class="o">--</span><span class="n">provider</span><span class="o">=</span><span class="n">hp</span>
</span></code></pre></td></tr></table></div></figure>



</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard">Posted by <span class="fn">Mohit Sethi</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2013-03-01T14:42:00+05:30" pubdate data-updated="true">Mar 1<span>st</span>, 2013</time>
          

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/devops/'>devops</a>, <a class='category' href='/blog/categories/vagrant/'>vagrant,</a>
  
</span>


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://appliedcode.github.io/blog/2013/03/01/vagrant-provider-for-hpcloud-dot-com/" data-via="mohitsethi" data-counturl="http://appliedcode.github.io/blog/2013/03/01/vagrant-provider-for-hpcloud-dot-com/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/2013/02/event-report-february-2nd-2012.html" title="Previous Post: Event Report:- February 2nd 2012:- Openstack talks at Manipal University">&laquo; Event Report:- February 2nd 2012:- Openstack talks at Manipal University</a></li>
            
            
            <li class="next"><a href="/blog/2013/07/29/git-ignore-file-permissions/" title="Next Post: Git Ignore file permissions">Git Ignore file permissions &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2014/02/09/creating-a-rubygem/">Creating a RubyGem</a>
    
    <a class="list-group-item " href="/blog/2013/07/29/git-ignore-file-permissions/">Git Ignore File Permissions</a>
    
    <a class="list-group-item active" href="/blog/2013/03/01/vagrant-provider-for-hpcloud-dot-com/">Vagrant Provider for hpcloud.com</a>
    
    <a class="list-group-item " href="/2013/02/event-report-february-2nd-2012.html">Event Report:- February 2nd 2012:- Openstack Talks at Manipal University</a>
    
  </div>
</section>

<section class="panel panel-default clearfix">
  <div class="panel-heading">
      <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="list-group" id="gh_repos">
    <p class="loading">Status updating...</p>
  </div>
  
    <div class="gh-profile-link pull-right text-muted">
      <a href="https://github.com/appliedcode">@appliedcode</a> on GitHub
    </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'appliedcode',
            count: 5,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





<section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Categories</h3>
  </div>
  <div class="list-group">
    
    
    <a class="list-group-item " href="/blog/categories/devops/index.html">
        <span class="badge">1</span>
        devops
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/vagrant,/index.html">
        <span class="badge">1</span>
        vagrant,
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/code,/index.html">
        <span class="badge">1</span>
        code,
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/git/index.html">
        <span class="badge">1</span>
        git
      </a>
    
    
    <a class="list-group-item " href="/blog/categories/ruby/index.html">
        <span class="badge">1</span>
        Ruby
      </a>
    
  </div>
</section>
    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2014 - Mohit Sethi<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/javascripts/libs/bootstrap-3.0.0/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'appliedcode';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://appliedcode.github.io/blog/2013/03/01/vagrant-provider-for-hpcloud-dot-com/';
        var disqus_url = 'http://appliedcode.github.io/blog/2013/03/01/vagrant-provider-for-hpcloud-dot-com/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </body>
</html>
